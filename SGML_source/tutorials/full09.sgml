@SG_ML_COMMENT This SGML documentation file is automatically generated by _ocu_mentation, the 05524F internal documentation generation app.
@SG_ML_PAGENAME Full Tutorial Part 9
@SG_ML_TITLE Full Tutorial Part 9
@SG_ML_BLANKLINE
&#9;See @SG_ML_L004006herefull08 for the previous part of the tutorial.
&#9;In the previous part, we wrote behaviours for the options page buttons that select which pattern to use.
@SG_ML_BLANKLINE
@SG_ML_HEADER_ writing options page behaviour (part 4)
&#9;We can now try to get the input field working and worry about presets later.
&#9;The input field in the options page is used for the user to input how many vertices they want in their star or polygon. Obviously this must be a integer that is at least 3, so we need to detect if that is the case.
@SG_ML_BLANKLINE
&#9;SGEXTN input fields (@SG_ML_L008014SGWInput../cppclass/sgwinput) have 3 @SG_ML_L021015callback function ⁽㈳㈴㈳㈮㈱㈨㈠㈫ ㈧㈤㈱㈤⁾../tutorials/callback attached (not including versions that pass stuff in arguments), that is @SG_ML_L01C036SGWInput::focusStartFunction../cppclass/sgwinput#void_ptr_focusStartFunction_func_, @SG_ML_L01A034SGWInput::focusEndFunction../cppclass/sgwinput#void_ptr_focusEndFunction_func_, and @SG_ML_L01D037SGWInput::textChangedFunction../cppclass/sgwinput#void_ptr_textChangedFunction_func_.
&#9;@SG_ML_L01C036SGWInput::focusStartFunction../cppclass/sgwinput#void_ptr_focusStartFunction_func_ triggers when the user clicks into the input field, @SG_ML_L01A034SGWInput::focusEndFunction../cppclass/sgwinput#void_ptr_focusEndFunction_func_ triggers when the user clicks out of the input field, and @SG_ML_L01D037SGWInput::textChangedFunction../cppclass/sgwinput#void_ptr_textChangedFunction_func_ triggers when the text in the input field is edited.
&#9;For input validation, @SG_ML_L01A034SGWInput::focusEndFunction../cppclass/sgwinput#void_ptr_focusEndFunction_func_ should be used. The @SG_ML_L021015callback function ⁽㈳㈴㈳㈮㈱㈨㈠㈫ ㈧㈤㈱㈤⁾../tutorials/callback argument in the constructor actually exists for you to pass a @SG_ML_L01A034SGWInput::focusEndFunction../cppclass/sgwinput#void_ptr_focusEndFunction_func_.
@SG_ML_BLANKLINE
&#9;In the @SG_ML_L021015callback function ⁽㈳㈴㈳㈮㈱㈨㈠㈫ ㈧㈤㈱㈤⁾../tutorials/callback attached to the input field, we should check if the text inside represents a integer at least 3. If it is not, we should mark the input field as invalid using @SG_ML_L01402ASGWInput::setInvalid../cppclass/sgwinput#void_setInvalid_bool_ and also show a warning below. Otherwise we hide the warning and mark the input field as not invalid.
&#9;Before we implement the function, we first need to make a warning. A warning is just a @SG_ML_L00C018SGWTextLabel../cppclass/sgwtextlabel with a darker colour, and can be created by passing true to the isWarning argument in the @SG_ML_L00C018SGWTextLabel../cppclass/sgwtextlabel constructor.
&#9;We declare a new variable in SGCLPOptionsPage
@SG_ML_WARN static SGWWidget* polygonSideCountWarning;
&#9;initialise it
@SG_ML_WARN SGWWidget* SGCLPOptionsPage::polygonSideCountWarning = nullptr;
&#9;and create it in SGCLPOptionsPage::initialise
@SG_ML_WARN SGCLPOptionsPage::polygonSideCountWarning = new SGWTextLabel(bg, "integer 3 or above", 0.5f, 0.1f, 0.0f, 15.5f, 0.5f, -0.6f, 0.0f, 0.75f, SGWHorizontalAlignment::Left, true);
&#9;Note that the font size is @SG_ML_L01A016w-distance ⁽㈳㈴㈳㈮㈱㈨㈠㈫ ㈧㈤㈱㈤⁾../tutorials/wdistance (0.0, 0.75) instead of the usual (0.0, 1.0). Also this is placed immediately below the input field. The warning is disabled upon creation and need to be manually enabled using @SG_ML_L01C032SGWWidget::setItemVisibility../cppclass/sgwwidget#void_setItemVisibility_bool_ when necessary.
@SG_ML_BLANKLINE
&#9;Then we can implement input validation.
&#9;First we declare the function
@SG_ML_WARN static void polygonSideCountCheck();
&#9;We then change the line creating the input field in SGCLPOptionsPage::initialise to use the function
@SG_ML_WARN SGCLPOptionsPage::polygonSideCountInput = new SGWTextInput(bg, &SGCLPOptionsPage::polygonSideCountCheck, 0.5f, 0.1f, 0.0f, 14.5f, 0.5f, -0.6f, 0.0f, 1.0f);
&#9;then we give a reasonable default of 3 vertices in SGCLPOptionsPage::reset
@SG_ML_WARN (*SGCLPOptionsPage::polygonSideCountInput).setTextFromInt(3);
&#9;Note that @SG_ML_L01802DSGWInput::setTextFromInt../cppclass/sgwinput#void_setTextFromInt_int_ directly sets the string representation of a integer to the input field. There is also @SG_ML_L01A031SGWInput::setTextFromFloat../cppclass/sgwinput#void_setTextFromFloat_float_ and the usual @SG_ML_L01B040SGWInput::setTextFromString../cppclass/sgwinput#void_setTextFromString_const_SGXString_ref_.
&#9;Finally we implement the function. @SG_ML_L016047SGWInput::getTextAsInt../cppclass/sgwinput#nodiscard_int_getTextAsInt_bool_ptr_int_int_const_ has built in range validation. There is also @SG_ML_L01804FSGWInput::getTextAsFloat../cppclass/sgwinput#nodiscard_float_getTextAsFloat_bool_ptr_float_float_const_ and @SG_ML_L019044SGWInput::getTextAsString../cppclass/sgwinput#nodiscard_SGXString_getTextAsString_func_const_.
@SG_ML_WARN void SGCLPOptionsPage::polygonSideCountCheck(){&#10;    bool isValid = true;&#10;    (void)((*SGCLPOptionsPage::polygonSideCountInput).getTextAsInt(&isValid, 3, SGLIntLimits::maximum()));&#10;    if(isValid == false){&#10;        (*SGCLPOptionsPage::polygonSideCountInput).setInvalid(true);&#10;        (*SGCLPOptionsPage::polygonSideCountWarning).setItemVisibility(true);&#10;    }&#10;    else{&#10;        (*SGCLPOptionsPage::polygonSideCountInput).setInvalid(false);&#10;        (*SGCLPOptionsPage::polygonSideCountWarning).setItemVisibility(false);&#10;    }&#10;}
&#9;Note that in this code we use @SG_ML_L00C018SGLIntLimits../cppclass/sglintlimits so we need to have
@SG_ML_WARN #include &lt;SGLIntLimits.h&gt;
&#9;@SG_ML_L00C018SGLIntLimits../cppclass/sglintlimits, @SG_ML_L00E01ASGLFloatLimits../cppclass/sglfloatlimits, and @SG_ML_L01101DSGLLongLongLimits../cppclass/sgllonglonglimits give the numeric limits of each data type. That includes the maximum representable number, minimum representable number, accuracy, etc.
@SG_ML_BLANKLINE
&#9;This almost works, but after testing we find 1 issue. If the input field contained invalid text but then is disabled by choosing another pattern, the warning still shows. To fix this we can modify the enabling and disabling logic.
@SG_ML_WARN void SGCLPOptionsPage::patternSelect(SGWButton *x){&#10;    (*SGCLPOptionsPage::patternCircleButton).setSelected(false);&#10;    (*SGCLPOptionsPage::patternPolygonButton).setSelected(false);&#10;    (*SGCLPOptionsPage::patternStarButton).setSelected(false);&#10;    (*SGCLPOptionsPage::patternFractalButton).setSelected(false);&#10;    (*x).setSelected(true);&#10;    if((*x).attachedInt == 0){&#10;        (*SGCLPOptionsPage::polygonSideCountInput).setItemVisibility(false);&#10;        (*SGCLPOptionsPage::polygonSideCountWarning).setItemVisibility(false);&#10;    }&#10;    else{&#10;        (*SGCLPOptionsPage::polygonSideCountInput).setItemVisibility(true);&#10;        if((*SGCLPOptionsPage::polygonSideCountInput).getInvalid() == true){(*SGCLPOptionsPage::polygonSideCountWarning).setItemVisibility(true);}&#10;    }&#10;}
@SG_ML_BLANKLINE
&#9;See @SG_ML_L004006herefull10 for the next part of the tutorial.
&#9;
