@SG_ML_COMMENT This SGML documentation file is automatically generated by _ocu_mentation, the 05524F internal documentation generation app.
@SG_ML_PAGENAME BuildLah Tutorial
@SG_ML_TITLE BuildLah Tutorial
@SG_ML_BLANKLINE
&#9;BuildLah is SGEXTN's system of CMake macros combined with a collection of GitHub Actions reusable actions that simplify building and packaging applications. This tutorial will cover all these features.
@SG_ML_BLANKLINE
@SG_ML_HEADER_ Contents
&#9;@SG_ML_L015006BuildLah CMake macros#cmake
&#9;@SG_ML_L017007BuildLah GitHub Actions#github
@SG_ML_BLANKLINE
@SG_ML_HEADER_cmake BuildLah CMake macros
&#9;Before you can use BuildLah, you first have to set it up so that it can be used by CMake. This can be done using the following commands.
@SG_ML_WARN cmake_minimum_required(VERSION 3.21 FATAL_ERROR)&#10;find_package(SGEXTN)&#10;BuildLah_use_default_settings()&#10;project([your project name] VERSION [your project version] LANGUAGES CXX)&#10;BuildLah_find_dependencies()
&#9;Remember to replace [your project name] and [your project version] with the actual project name and version.
&#9;You are strongly recommended to set the CMake behaviour to 3.21 as BuildLah was tested using that version. Using other versions can cause issues with the build.
&#9;There is no need to set any CMake setting manually or patch improperly configured Qt CMake targets, that is done automatically. Finding the Qt and SGEXTN targets is also done automatically and there is no need for additional find_package commands unless you intend to use additional Qt modules or 3rd party libraries.
&#9;If you want to specify a specific path to SGEXTN, you can directly include the SG_ALL_Targets.cmake file instead of running find_package. This can be helpful if you have SGEXTN for multiple platforms installed on your computer.
@SG_ML_BLANKLINE
&#9;Next we can use the BuildLah_add_component macro to define targets. The syntax is
&#9;BuildLah_add_component(TARGET_NAME TARGET_TYPE ROOT_FOLDER BUILD_DEFINE USE_DEFINE RESOURCE_PREFIX DEPENDENCY1 DEPENDENCY2 DEPENDENCY3 ...)
&#9;TARGET_NAME - name of the CMake target created, make sure that you do not have 2 targets with the same name
&#9;TARGET_TYPE - GUI for normal applications, CLI for command line applications, and DLL for shared libraries (on all platforms, not just Windows)
&#9;ROOT_FOLDER - root folder of this CMake target, this will determine where BuildLah searches for relevant files
&#9;BUILD_DEFINE - preprocessor #define directive defined when compiling source files in the CMake target, this can be used to export shared library symbols
&#9;USE_DEFINE - preprocessor #define directive defined when compiling source files in CMake targets that link to this CMake target, this can be used to import shared library symbols
&#9;RESOURCE_PREFIX - prefix used in the resource system, the resource file ROOT_FOLDER/assets/something.png will be accessible in the resource system as :/RESOURCE_PREFIX/something.png, the shader ROOT_FOLDER/shaders/something.vert will be accessible in the resource system as :/RESOURCE_PREFIX/something.vert.qsb
&#9;DEPENDENCY1 DEPENDENCY2 DEPENDENCY3 ... - space separated list of shared libraries to link to, can be empty if there is no need to link to anything, the Standard Template Library is always linked by default and does not have to be included here
@SG_ML_BLANKLINE
&#9;BuildLah defines 4 special folders, the headers folder at ROOT_FOLDER/include, the sources folder at ROOT_FOLDER/src, the assets folder at ROOT_FOLDER/assets, and the shaders folder at ROOT_FOLDER/shaders. All files in the headers folder will be made available for the preprocessor include directive, all files in the sources folder will be compiled, all files in the assets folder will be added to the resource system, and all files in the shaders folder will be compiled as GLSL shaders and added to the resource system.
&#9;If files change in any of the 4 folders, the build commands will be updated automatically. There is no need to manually reconfigure CMake.
&#9;If something is not supposed to be included in the build, do not put it in any of the 4 folders. If you really want to, you can put it inside ROOT_FOLDER/others, but it is best to not put it in ROOT_FOLDER at all.
&#9;This version of BuildLah does not support preparing the build results for installation, support may be added in a future version.
@SG_ML_BLANKLINE
&#9;To build the SGEXTN app for testing locally, simply click the "build" or "run" button at the bottom left of Qt Creator. Note that this will not package the application properly and it should not be distributed. To build and package your application for distribution, use the BuildLah GitHub Actions instead.
@SG_ML_BLANKLINE
@SG_ML_HEADER_github BuildLah GitHub Actions
&#9;There is also a collection of GitHub Actions provided as part of BuildLah and they should be used to build and package applications for distribution. Using the BuildLah GitHub Actions ensures a consistent build environment. Starting from likely SGEXTN version 6.4.0, the application will also be tested.
&#9;To use these GitHub Actions, you will need to write a workflow that invokes the BuildLah workflow. This should be in a file .github/workflows/build.yaml in the repository. The script should look like this.
@SG_ML_WARN name: build app&#10;&#10;on:&#10;  workflow_dispatch:&#10;&#10;jobs:&#10;  build:&#10;    uses: InfinityIntegral/SGEXTN/.github/workflows/BuildLah.yaml@main&#10;    with:&#10;      app-name: ...&#10;      app-version: ...&#10;      qt-version: ...&#10;      cmake-target-name: ...&#10;      user-facing-app-name: ...&#10;      user-facing-app-version: ...&#10;      app-icon: ...&#10;      user-facing-organisation-name: ...&#10;      bundle-id: ...&#10;      app-category: ...&#10;      licensing: ...&#10;      license-file: ...&#10;      app-description: ...&#10;      platforms: ...
&#9;Remember to replace the ... with the actual value for each input. The meaning of each input is shown below.
@SG_ML_WARN inputs:&#10;  app-name:&#10;    required: true&#10;    description: name of your application executable, example my-application&#10;    type: string&#10;  app-version:&#10;    required: true&#10;    description: version number of your application, example 1.0.0&#10;    type: string&#10;  qt-version:&#10;    required: true&#10;    description: version of Qt to use, it is preferred that this matches the Qt version you have on your development machine, example 6.10.1&#10;    type: string&#10;  cmake-target-name:&#10;    required: true&#10;    description: name of CMake target for your application executable, this is used to locate the executable, the executable will be renamed after that&#10;    type: string&#10;  user-facing-app-name:&#10;    required: true&#10;    description: application name as how you want the user to see it, this does not need to be a valid file name, example My Application&#10;    type: string&#10;  user-facing-app-version:&#10;    required: true&#10;    description: application version as how you want the user to see it, this does not need to be numerical, example version 1.0.0&#10;    type: string&#10;  app-icon:&#10;    required: true&#10;    description: location of the application icon PNG image as a path in your GitHub repository, example assets/icon.png&#10;    type: string&#10;  user-facing-organisation-name:&#10;    required: true&#10;    description: your organisation name as how you want the user to see it, example 05524F.sg&#10;    type: string&#10;  bundle-id:&#10;    required: true&#10;    description: application bundle identifier, only used on MacOS, iOS, and Android, must be a reverse URL style dot separated list, with every entry containing only lowercase letters and numbers and must start with a lowercase letter, example sg.singapore05524f.myapplication&#10;    type: string&#10;  app-category:&#10;    required: true&#10;    description: one from the list AudioVideo, Audio, Video, Development, Education, Game, Graphics, Network, Office, Science, Settings, System, Utility, only used on Linux, example Utility&#10;    type: string&#10;  licensing:&#10;    required: true&#10;    description: software licensing for your application, you are strongly recommended to use General Public License version 3 (GPLv3), the license file from your GitHub repository will always be copied regardless of this input, example GPLv3&#10;    type: string&#10;  license-file:&#10;    required: true&#10;    description: path to the license file in your GitHub repository, typically LICENSE.txt, example LICENSE.txt&#10;    type: string&#10;  app-description:&#10;    required: true&#10;    description: a short explanatory note to the user what the app is about&#10;    type: string&#10;  platforms:&#10;    required: true&#10;    description: space separated list of platforms to build for paired with compiler to use, each job in this workflow corresponds to a supported platform, example linux-gcc windows-llvm-mingw&#10;    type: string
@SG_ML_BLANKLINE
&#9;After this finishes running, if your code compiles successfully, you should see a [platform]-binary and a [platform]-build artifact produced for each platform that you selected. The [platform]-binary artifact is the output of the build process, and the [platform]-build artifact is included for debugging purposes.
&#9;For Windows: the [platform]-binary zip file can be distributed directly, though you may want to sign it first if you have the relevant certificates so that user machines do not complain
&#9;For MacOS: you must sign the .app bundle inside the unzipped [platform]-binary folder and distribute the bundle through the App Store
&#9;For Linux: the [platform]-binary zip file can be distributed directly
&#9;For Android: the APK in the unzipped [platform]-binary folder can be distributed directly since it was signed with a debug key, but it is recommended that you re sign it with a real key. For distribution via Google Play, build for Android AAB instead
&#9;For Android AAB: you must sign the AAB in the unzipped [platform]-binary folder and distribute it through Google Play
&#9;For iOS: currently unsupported as 05524F does not have a Apple Developer subscription and cannot test it
&#9;For WebASM: currently unsupported due to licensing concerns, support may be added in future if SGEXTN gets dual licensed between LGPL and GPL
@SG_ML_BLANKLINE
&#9;You should pass a space separated list of platform names to the platforms input. The list of all currently supported platforms is below.
&#9;linux-gcc: Linux AMD64, uses builtin compiler, compatible with anything with glibc newer than or equal to the one on Ubuntu 22.04
&#9;linux-arm-gcc: Linux ARM64, uses builtin compiler, compatible with anything with glibc newer than or equal to the one on Ubuntu 24.04
&#9;macos-clang: MacOS, uses AppleClang compiler, compatible with both Intel and Apple Silicon Macs
&#9;windows-llvm-mingw: Windows AMD64, uses LLVM-MinGW compiler that comes with Windows Qt
&#9;windows-mingw: Windows AMD64, uses MinGW compiler that comes with Windows Qt
&#9;windows-msvc: Windows AMD64, uses MSVC compiler that comes with Windows Qt
&#9;windows-arm-msvc: Windows ARM64, uses MSVC compiler that comes with Windows Qt
&#9;android-arm64-clang: Android ARM64, uses Android SDK + NDK
&#9;android-arm32clang: Android ARM32, uses Android SDK + NDK
&#9;android-amd64-clang: Android AMD64, uses Android SDK + NDK
&#9;android-amd32-clang: Android AMD32, uses Android SDK + NDK
&#9;android-aab-clang: Android AAB for Google Play, uses Android SDK + NDK
&#9;
